<?xml version="1.0" encoding="utf-8"?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="LepreCoinsApp.Views.SettingsPage"
             xmlns:viewModels="clr-namespace:LepreCoinsApp.ViewModels"
             Title="ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸"
             BackgroundColor="#0F1419">

    <ContentPage.BindingContext>
        <viewModels:SettingsViewModel />
    </ContentPage.BindingContext>

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">

            <!-- Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº -->
            <Label Text="ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸"
                   FontSize="28"
                   FontAttributes="Bold"
                   TextColor="#333" />

            <!-- ÐŸÐ¾Ñ€Ð¾Ð³ Ð½Ð¸Ð·ÐºÐ¾Ð³Ð¾ Ð±Ð°Ð»Ð°Ð½ÑÐ° -->
            <Frame BorderColor="#ddd" CornerRadius="10" Padding="15">
                <VerticalStackLayout Spacing="10">
                    <Label Text="ÐŸÐ¾Ñ€Ð¾Ð³ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ Ð¾ Ð½Ð¸Ð·ÐºÐ¾Ð¼ Ð±Ð°Ð»Ð°Ð½ÑÐµ"
                           FontSize="14"
                           TextColor="#666" />
                    <HorizontalStackLayout Spacing="10" VerticalOptions="Center">
                        <Slider Minimum="0"
                                Maximum="100000"
                                Value="{Binding LowBalanceThreshold}"
                                ValueChanged="OnLowBalanceThresholdChanged"
                                HorizontalOptions="FillAndExpand" />
                        <Label Text="{Binding LowBalanceThreshold, StringFormat='{0:C}'}"
                               WidthRequest="90"
                               HorizontalTextAlignment="End" />
                    </HorizontalStackLayout>
                </VerticalStackLayout>
            </Frame>

            <!-- Ð¢ÐµÐ¼Ð° Ð¸ ÑƒÐ²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ -->
            <Frame BorderColor="#ddd" CornerRadius="10" Padding="15">
                <VerticalStackLayout Spacing="15">

                    <Grid ColumnDefinitions="*,Auto" ColumnSpacing="10">
                        <Label Text="Ð¢Ñ‘Ð¼Ð½Ð°Ñ Ñ‚ÐµÐ¼Ð°"
                               FontSize="14"
                               VerticalOptions="Center" />
                        <Switch Grid.Column="1"
                                IsToggled="{Binding IsDarkMode}"
                                Toggled="OnThemeToggled" />
                    </Grid>

                    <Grid ColumnDefinitions="*,Auto" ColumnSpacing="10">
                        <Label Text="Ð£Ð²ÐµÐ´Ð¾Ð¼Ð»ÐµÐ½Ð¸Ñ"
                               FontSize="14"
                               VerticalOptions="Center" />
                        <Switch Grid.Column="1"
                                IsToggled="{Binding EnableNotifications}" />
                    </Grid>

                    <Grid ColumnDefinitions="*,Auto" ColumnSpacing="10">
                        <Label Text="ÐžÑ„Ð»Ð°Ð¹Ð½-Ñ€ÐµÐ¶Ð¸Ð¼"
                               FontSize="14"
                               VerticalOptions="Center" />
                        <Switch Grid.Column="1"
                                IsToggled="{Binding EnableOfflineMode}" />
                    </Grid>

                </VerticalStackLayout>
            </Frame>

            <!-- Ð’Ð°Ð»ÑŽÑ‚Ð° -->
            <Frame BorderColor="#ddd" CornerRadius="10" Padding="15">
                <VerticalStackLayout Spacing="10">
                    <Label Text="Ð’Ð°Ð»ÑŽÑ‚Ð°"
                           FontSize="14"
                           TextColor="#666" />
                    <Picker SelectedItem="{Binding Currency}">
                        <Picker.Items>
                            <x:String>RUB</x:String>
                            <x:String>USD</x:String>
                            <x:String>EUR</x:String>
                        </Picker.Items>
                    </Picker>
                </VerticalStackLayout>
            </Frame>

            <!-- ÐšÐ½Ð¾Ð¿ÐºÐ¸ Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ð¹ -->
            <VerticalStackLayout Spacing="10">

                <Button Text="ðŸ’¾ Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸"
                        Command="{Binding SaveSettingsCommand}"
                        BackgroundColor="#27ae60"
                        TextColor="White"
                        CornerRadius="8" />

                <Button Text="ðŸ§¹ ÐžÑ‡Ð¸ÑÑ‚Ð¸Ñ‚ÑŒ ÐºÑÑˆ"
                        Clicked="OnClearCacheClicked"
                        BackgroundColor="#e67e22"
                        TextColor="White"
                        CornerRadius="8" />

                <Button Text="ðŸ”„ ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ"
                        Command="{Binding CheckForUpdatesCommand}"
                        BackgroundColor="#3498db"
                        TextColor="White"
                        CornerRadius="8" />

                <Button Text="ðŸšª Ð’Ñ‹Ð¹Ñ‚Ð¸ Ð¸Ð· Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚Ð°"
                        Clicked="OnLogoutClicked"
                        BackgroundColor="#e74c3c"
                        TextColor="White"
                        CornerRadius="8" />
            </VerticalStackLayout>

            <!-- Ð’ÐµÑ€ÑÐ¸Ñ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ -->
            <Label Text="{Binding AppVersion, StringFormat='Ð’ÐµÑ€ÑÐ¸Ñ Ð¿Ñ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ: {0}'}"
                   FontSize="12"
                   TextColor="#999"
                   HorizontalOptions="Center"
                   Margin="0,20,0,0" />

            <!-- Ð˜Ð½Ð´Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ Ð·Ð°Ð³Ñ€ÑƒÐ·ÐºÐ¸ -->
            <StackLayout IsVisible="{Binding IsBusy}" Spacing="5" HorizontalOptions="Center">
                <ActivityIndicator IsRunning="{Binding IsBusy}" />
                <Label Text="{Binding BusyText}" FontSize="12" TextColor="#999" />
            </StackLayout>

        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
